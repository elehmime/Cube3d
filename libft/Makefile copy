CC = gcc
# Options de compilation
CFLAGS = -Wall -Wextra -Werror
# Dossier contenant la libft et son chemin d'inclusion
LIBFT_DIR = ./libft
LIBFT_INC = -I$(LIBFT_DIR)
LIBFT_LIB = -L$(LIBFT_DIR) -lft

# Sources et objets pour le serveur et le client
SRC = so_long.c
OBJ = $(SRC:.c=.o)

# Noms des exécutables
SO_LONG_BIN = so_long

# Règle par défaut pour compiler le serveur et le client
all: $(SO_LONG_BIN)

# Compilation de la libft
$(LIBFT_DIR)/libft.a:
	$(MAKE) -C $(LIBFT_DIR)

# Règle générique pour convertir les .c en .o
%.o: %.c
	$(CC) $(CFLAGS) $(LIBFT_INC) -c $< -o $@

# Compilation du serveur
$(SO_LONG_BIN): $(OBJ) $(LIBFT_DIR)/libft.a
	$(CC) $(OBJ) $(LIBFT_LIB) -o $@

# Nettoyage des fichiers compilés
clean:
	rm -f $(OBJ)
	$(MAKE) -C $(LIBFT_DIR) clean

# Suppression de tout ce qui a été compilé
fclean: clean
	rm -f $(SO_LONG_BIN)
	$(MAKE) -C $(LIBFT_DIR) fclean

# Recompilation de tout
re: fclean all

# Empêcher make de confondre un fichier et une règle
.PHONY: all clean fclean re

